## 17.1 网络基础

网络编程需要程序员掌握一下基础的网络知识，这一节先介绍一些网络基础知识。

### 17.1.1 网络结构

首先了解一下网络结构，网络结构是网络的构建方式，目前流行的有客户端服务器结构网络和对等结构网络。

#####1.  客户端服务器结构网络

客户端服务器（Client Server，缩写C/S）结构网络，是一种主从结构网络。如图17-1所示，服务器一般处于等待状态，如果有客户端请求，服务器响应请求建立连接提供服务。服务器是被动的，有点像在餐厅吃饭时候的服务员。而客户端是主动的，像在餐厅吃饭的顾客。

![17-1](.../assets/17-1.jpg)

图17-1　客户端服务器结构网络

事实上，生活中很多网络服务都采用这种结构。例如：Web服务、文件传输服务和邮件服务等。虽然它们存在的目的不一样，但基本结构是一样的。这种网络结构与设备类型无关，服务器不一定是电脑，也可能是手机等移动设备。

#####2.  对等结构网络

对等结构网络也叫点对点网络（Peer to Peer，缩写P2P），每个节点之间是对等的。它们如图17-2所示，每个节点既是服务器又是客户端，这种结构有点像吃自助餐。

![17-2](.../assets/17-2.jpg)

图17-2　对等结构网络

对等结构网络分布范围比较小。通常在一间办公室或一个家庭内，因此它非常适合于移动设备间的网络通讯，网络链路层是由蓝牙和WiFi实现。

### 17.1.2 TCP/IP协议

网络通信会用到协议，其中TCP/IP协议是非常重要的。TCP/IP协议是由IP和TCP两个协议构成的，IP（Internet Protocol）协议是一种低级的路由协议，它将数据拆分成许多小的数据包中，并通过网络将它们发送到某一特定地址，但无法保证都所有包都抵达目的地，也不能保证包的顺序。

由于IP协议传输数据的不安全性，网络通信时还需要TCP协议，传输控制协议（Transmission Control Protocol，TCP）是一种高层次的协议，面向连接的可靠数据传输协议，如果有些数据包没有收到会重发，并对数据包内容准确性检查并保证数据包顺序，所以该协议保证数据包能够安全地按照发送时顺序送达目的地。

### 17.1.3 IP地址

为实现网络中不同计算机之间的通信，每台计算机都必须有一个与众不同的标识，这就是IP地址，TCP/IP使用IP地址来标识源地址和目的地址。最初所有的IP地址都是32位数字构成，由4个8位的二进制数组成，每8位之间用圆点隔开，如：192.168.1.1，这种类型的地址通过IPv4指定。而现在有一种新的地址模式称为IPv6，IPv6使用128位数字表示一个地址，分为8个16位块。尽管IPv6比IPv4有很多优势，但是由于习惯的问题，很多设备还是采用IPv4。不过Java语言同时指出IPv4和IPv6。

在IPv4地址模式中IP地址分为A、B、C、D和E等5类。

*   A类地址用于大型网络，地址范围：1.0.0.1~126.155.255.254。
*   B类地址用于中型网络，地址范围：128.0.0.1~191.255.255.254。
*   C类地址用于小规模网络，192.0.0.1~223.255.255.254。
*   D类地址用于多目的地信息的传输和作为备用。
*   E类地址保留仅作实验和开发用。

另外，有时还会用到一个特殊的IP地址127.0.0.1，127.0.0.1称为回送地址，指本机。主要用于网络软件测试以及本地机进程间通信，使用回送地址发送数据，不进行任何网络传输，只在本机进程间通信。

### 17.1.4 端口

一个IP地址标识这一台计算机，每一台计算机又有很多网络通信程序在运行，提供网络服务或进行通信，这就需要不同的端口进行通信。如果把IP地址比作电话号码，那么端口就是分机号码，进行网络通信时不仅要指定IP地址，还要指定端口号。

TCP/IP系统中的端口号是一个16位的数字，它的范围是0~65535。小于1024的端口号保留给预定义的服务，如HTTP是80，FTP是21，Telnet是23，Email是25等，除非要和那些服务进行通信，否则不应该使用小于1024的端口。